<?xml version="1.0" encoding="UTF-8"?>
<project default="javadoc">

    <target name="check-package-list">
        <available file="javadoc/eclipse-package-list/package-list" property="package-list-available" />
        <available file="javadoc/java-package-list/package-list" property="package-list-available" />
        <available file="javadoc/javax-package-list/package-list" property="package-list-available" />
    </target>

    <target name="fetch-package-list" unless="package-list-available">
        <delete dir="javadoc" />
        <mkdir dir="javadoc/eclipse-package-list" />
        <mkdir dir="javadoc/java-package-list" />
        <mkdir dir="javadoc/javax-package-list" />
        <get dest="javadoc/eclipse-package-list/package-list" src="http://help.eclipse.org/help33/topic/org.eclipse.platform.doc.isv/reference/api/package-list" />
        <get dest="javadoc/java-package-list/package-list" src="http://java.sun.com/j2se/1.5.0/docs/api/package-list" />
        <get dest="javadoc/javax-package-list/package-list" src="http://java.sun.com/javaee/5/docs/api/package-list" />
    </target>

    <target name="javadoc" depends="check-package-list,fetch-package-list">
        <condition property="junit.dir" value="junit4_3">
            <isset property="isJunit4.3" />
        </condition>
        <property name="junit.dir" value="junit4_5"/>

        <delete dir="artifacts/apidocs" />
        <javadoc destdir="artifacts/apidocs" access="protected" author="true" splitindex="true" use="true" version="true" source="1.5" doctitle="Nuxeo Apogee API Documentation" nodeprecated="false" nodeprecatedlist="false" noindex="false" nonavbar="false" notree="false" useexternalfile="true" packagenames="org.nuxeo.*">
            <sourcepath>
                <dirset dir="../../plugins">
                    <include name="org.nuxeo.ecm.rcp.nl/src" />
                    <include name="org.nuxeo.ecm.rcp.collab/src" />
                    <include name="org.nuxeo.ecm.rcp.comments.nl/src" />
                    <include name="org.nuxeo.ecm.rcp.htmleditor/src" />
                    <include name="org.nuxeo.rcp.spellchecking.myspell/src" />
                    <include name="org.nuxeo.ecm.rcp.application.nl/src" />
                    <include name="org.nuxeo.apogee.forms/src" />
                    <include name="org.nuxeo.ecm.rcp.usermanager/src" />
                    <include name="org.nuxeo.rcp.ui.nl/src" />
                    <include name="org.nuxeo.ecm.rcp.usermanager.nl/src" />
                    <include name="org.nuxeo.apogee/src" />
                    <include name="org.nuxeo.runtime.config/src" />
                    <include name="org.nuxeo.ecm.rcp.application/src" />
                    <include name="org.nuxeo.ecm.rcp.audit/src" />
                    <include name="org.nuxeo.ecm.rcp.versioning/src" />
                    <include name="org.nuxeo.ecm.rcp.versioning.nl/src" />
                    <include name="org.nuxeo.ecm.rcp.audit.nl/src" />
                    <include name="org.nuxeo.ecm.client/src" />
                    <include name="org.nuxeo.rcp.spellchecking.ui/src" />
                    <include name="org.nuxeo.rcp.spellchecking.ui.forms/src" />
                    <include name="org.nuxeo.ecm.rcp.usermanager.userformcontribution/src" />
                    <include name="org.nuxeo.rcp.spellchecking/src" />
                    <include name="org.nuxeo.apogee.forms.test/src" />
                    <include name="org.nuxeo.ecm.platform.rcp/src" />
                    <include name="org.nuxeo.imagegrid/src" />
                    <include name="org.nuxeo.ecm.rcp.comments/src" />
                    <include name="org.apache.log4j.config/src" />
                    <include name="org.nuxeo.ecm.rcp.forms/src" />
                    <include name="org.nuxeo.ecm.rcp.im/src" />
                    <include name="org.nuxeo.eclipse.ui/src" />
                    <include name="org.nuxeo.rcp.imagegrid.nl/src" />
                    <include name="org.nuxeo.rcp.photoeditor/src" />
                    <include name="au.com.bytecode.opencsv" />
                </dirset>
            </sourcepath>
            <classpath>
                <fileset dir="${nuxeo-sdk}/plugins">
                    <include name="**/*.jar" />
                </fileset>
                <fileset dir="${swt-composer-sdk}/plugins">
                    <include name="**/*.jar" />
                </fileset>
                <fileset dir="${eclipse-target}/plugins">
                    <include name="**/*.jar" />
                </fileset>
            </classpath>
            <link href="http://help.eclipse.org/help33/topic/org.eclipse.platform.doc.isv/reference/api" offline="true" packagelistloc="javadoc/eclipse-package-list" />
            <link href="http://java.sun.com/j2se/1.5.0/docs/api/" offline="true" packagelistloc="javadoc/java-package-list" />
            <link href="http://java.sun.com/javaee/5/docs/api/" offline="true" packagelistloc="javadoc/javax-package-list" />
        </javadoc>
    </target>
</project>
